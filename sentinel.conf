# VPS Sentinel - Configuration File
# Installed to: /etc/sentinel/sentinel.conf

# ============================================================
# REQUIRED: Set these after installation
# ============================================================

# Your IP address (never blocked, excluded from traffic stats)
MY_IP=""

# Server's own public IP address
SERVER_IP=""

# Additional trusted IPs (space-separated)
TRUSTED_IPS=""

# ============================================================
# Log paths (defaults work for standard Ubuntu/Debian + nginx)
# ============================================================
NGINX_LOG="/var/log/nginx/access.log"
AUTH_LOG="/var/log/auth.log"
F2B_LOG="/var/log/fail2ban.log"
EXPLOIT_LOG="/var/log/nginx/blocked_exploits.log"

# Sentinel's own log directory
SENTINEL_LOG_DIR="/var/log/sentinel"
SENTINEL_LOG="${SENTINEL_LOG_DIR}/sentinel.log"
BLOCKED_LOG="${SENTINEL_LOG_DIR}/blocked_ips.log"
REPORT_DIR="${SENTINEL_LOG_DIR}"

# ============================================================
# Branding
# ============================================================
PROJECT_NAME="VPS Sentinel"

# ============================================================
# Computed values (do not edit)
# ============================================================

# Full whitelist: MY_IP + SERVER_IP + TRUSTED_IPS + loopback
WHITELIST="127.0.0.1 ::1"
[ -n "$MY_IP" ] && WHITELIST="$MY_IP $WHITELIST"
[ -n "$SERVER_IP" ] && WHITELIST="$SERVER_IP $WHITELIST"
[ -n "$TRUSTED_IPS" ] && WHITELIST="$TRUSTED_IPS $WHITELIST"

# Grep-safe exclusion pattern (pipe-separated for grep -vE)
_build_exclude() {
    local pattern=""
    for ip in $WHITELIST; do
        local escaped=$(echo "$ip" | sed 's/\./\\./g')
        [ -n "$pattern" ] && pattern="${pattern}|${escaped}" || pattern="$escaped"
    done
    echo "$pattern"
}
WHITELIST_PATTERN=$(_build_exclude)
